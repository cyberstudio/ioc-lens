# Инструкции для разработчиков

В документе описана структура проекта и информация по его разработке.

## Команды для работы с проектом

Установка зависимостей

```sh
yarn
```

Запуск проекта расширения. Будет запушен webpack-dev-server, который будет отслеживать все изменения и пересобирать проект.

```sh
yarn start
```

Запуск проекта демонстрации UI-компонентов. Будет запущен webpack-dev-server на `localhost:9000` со страницей примеров компонентов

```sh
yarn start:ui-book
```

Сборка файлов расширения. Может понадобится для CI, когда нужно будет собрать итоговые файлы для расширения

```sh
yarn build
```

Сборка CSS-файлов из токенов дизайн-системы. Необходимо выполнять после обновления версии токенов, а также при добавлении токенов новых компонентов.

```sh
yarn build:tokens
```

Анализ typescript-кода на соответствие правилам ESLint

```sh
yarn lint:ts
```

Анализ CSS на соответствие правилам StyleLint

```sh
yarn lint:ts
```

Запуск тестов проекта

```sh
yarn test
```

## Технологии

-   HTML
-   CSS
-   TypeScript
-   UVU
-   Yarn
-   Webpack
-   ESLint
-   StyleLint
-   LeftHook
-   StyleDictionary

## Структура проекта

-   `/src` - основной код проекта
    -   `/apps/extension` - приложение расширения, а также все необходимые для него ресурсы
    -   `/apps/ui-book` - приложение для демонстрации основных UI-компонентов проекта
    -   `/modules` - общие модули для расширения и приложения демонстрации UI-компонентов проекта
        -   `/api` - модуль для работы с API бекенда
        -   `/design-system` - модуль дизайн системы, которая используется при разработке UI
        -   `/features` - модули отдельных функциональностей расширения
        -   `/shared` - общие модуль, в котором расположены общие файлы остальных модулей, например базовые UI-компоненты, сервисы или хранилища

## Процесс разработки

### Организация командной работы

Основная ветка разработки - `master`.

Разработка новой функциональности ведется в отдельных ветках:

-   `feat/{task-number}{-optional-suffix}` - новая функциональность
-   `bugfix/{task-number}{-optional-suffix}` - исправление багов
-   `tech/{task-number}{-optional-suffix}` - рефакторинг

Новые ветки вливаются в `master` через открытие PullRequest/MergeRequest и после прохождения ревью членами команды разработки.

### Особенности разработки расширения

Для проверки работы расширения в процессе работы над ним необходимо установить его в GoogleChrome через страницу установки расширений в режиме разработчика.

После включения этого режима необходимо загрузить распакованное расширение, указав директорию `dist/extension` в качестве места, где расположены собранные файлы.

После этого, при обновлении файлов в этой директории, расширение будет автоматически обновляться. Иногда может потребоваться ручное обновление, если изменения были в фоновых скриптах. Это делается на странице списка расширений, по кнопке обновления у конкретного расширения.
